{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { BASE_URL, patchConfigure } from \"../../Api/api\";\nimport { toast } from \"react-toastify\";\nexport const fetchOrders = createAsyncThunk('orders/fetchOrders', async _ref => {\n  let {\n    signal\n  } = _ref;\n  const res = await fetch(`${BASE_URL}/orders?_sort=id&_order=desc`, {\n    signal\n  });\n  const data = await res.json();\n\n  if (!res.ok) {\n    throw new Error(res.statusText);\n  }\n\n  return data;\n});\nexport const updateOrderStatus = createAsyncThunk('orders/updateOrderStatus', async _ref2 => {\n  let {\n    id,\n    updateData\n  } = _ref2;\n  const res = await fetch(`${BASE_URL}/orders/${id}`, patchConfigure(updateData));\n  const data = await res.json();\n  const status = res.ok;\n  return {\n    id,\n    data,\n    status\n  };\n});\nconst ordersSlice = createSlice({\n  name: 'orders',\n  initialState: {\n    error: false,\n    orders: []\n  },\n  extraReducers: builder => {\n    builder.addCase(fetchOrders.fulfilled, (state, action) => {\n      state.error = false;\n      state.orders = action.payload;\n    });\n    builder.addCase(fetchOrders.rejected, (state, action) => {\n      const error = action.error;\n      state.orders = [];\n\n      if (error.name !== 'AbortError') {\n        state.error = error.message;\n      }\n    });\n    builder.addCase(updateOrderStatus.pending, state => {\n      toast.dismiss();\n      toast.info('Updating');\n    });\n    builder.addCase(updateOrderStatus.fulfilled, (state, action) => {\n      toast.dismiss();\n      toast.success('Updating');\n      const {\n        id,\n        data\n      } = action.payload;\n      const targetIndex = state.orders.findIndex(order => order.id === Number(id));\n\n      if (targetIndex) {\n        state.orders[targetIndex] = { ...state.orders[targetIndex],\n          ...data\n        };\n      }\n    });\n    builder.addCase(updateOrderStatus.rejected, (state, action) => {\n      const error = action.error;\n      toast.dismiss();\n      toast.error(error.message);\n    });\n  }\n});\nexport default ordersSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","BASE_URL","patchConfigure","toast","fetchOrders","signal","res","fetch","data","json","ok","Error","statusText","updateOrderStatus","id","updateData","status","ordersSlice","name","initialState","error","orders","extraReducers","builder","addCase","fulfilled","state","action","payload","rejected","message","pending","dismiss","info","success","targetIndex","findIndex","order","Number","reducer"],"sources":["C:/Users/DELL/OneDrive/Desktop/New folder/New folder/src/App/features/ordersSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { BASE_URL, patchConfigure } from \"../../Api/api\";\nimport { toast } from \"react-toastify\";\n\nexport const fetchOrders = createAsyncThunk(\n    'orders/fetchOrders',\n    async ({signal}) => {\n        const res = await fetch(`${BASE_URL}/orders?_sort=id&_order=desc`, {signal});\n        const data = await res.json();\n\n        if (!res.ok){\n            throw new Error(res.statusText)\n        }\n\n        return data\n    }\n)\n\nexport const updateOrderStatus = createAsyncThunk(\n    'orders/updateOrderStatus',\n    async ({ id, updateData}) => {\n        const res = await fetch(`${BASE_URL}/orders/${id}`, patchConfigure(updateData))\n        const data = await res.json();\n        const status = res.ok\n        return { id, data, status}\n    }\n)\n\nconst ordersSlice = createSlice({\n    name: 'orders',\n    initialState: {\n        error: false,\n        orders: []\n    },\n    extraReducers: (builder) => {\n        builder.addCase(fetchOrders.fulfilled, (state, action) => {\n            state.error = false;\n            state.orders = action.payload;\n        });\n        builder.addCase(fetchOrders.rejected, (state, action) => {\n            const error = action.error\n            state.orders = []\n\n            if (error.name !== 'AbortError'){\n                state.error = error.message\n            }\n        });\n        \n        builder.addCase(updateOrderStatus.pending, (state) => {\n            toast.dismiss();\n            toast.info('Updating');\n        });\n        builder.addCase(updateOrderStatus.fulfilled, (state, action) => {\n            toast.dismiss();\n            toast.success('Updating');\n            const { id, data } = action.payload;\n\n            const targetIndex = state.orders.findIndex(order => order.id === Number(id));\n            if(targetIndex) {\n                state.orders[targetIndex] = { ...state.orders[targetIndex], ...data}\n            }\n        });\n        builder.addCase(updateOrderStatus.rejected, (state, action) => {\n            const error = action.error\n            toast.dismiss();\n            toast.error(error.message);\n        });\n    }\n})\n\nexport default ordersSlice.reducer"],"mappings":"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"},"metadata":{},"sourceType":"module"}