{"ast":null,"code":"import { encodeVersion } from \"./encodeVersion.js\";\nimport { getAnalyticsOptions } from \"./getAnalyticsOptions.js\";\nimport { packageVersion } from \"../internal/utils/packageVersion.js\";\nimport { encodeOSVersion } from \"./encodeOSVersion.js\";\n/**\n * @private\n * @description Try to get the node version out of process, if browser just return 0.0.0\n */\n\nfunction getNodeVersion() {\n  const failedVersion = '0.0.0';\n\n  if (typeof window !== 'undefined') {\n    return failedVersion;\n  } else {\n    // node env\n    try {\n      return process.versions.node || failedVersion;\n    } catch (e) {\n      return failedVersion;\n    }\n  }\n}\n/**\n * @private\n * @description Ensure that all values ITrackedPropertiesThroughAnalytics are populated.\n * Accept a partial map of values and returns the complete interface of ITrackedPropertiesThroughAnalytics\n * @param {ITrackedPropertiesThroughAnalytics} trackedAnalytics\n * @param {ITrackedPropertiesThroughAnalytics} trackedAnalytics\n */\n\n\nfunction ensureShapeOfTrackedProperties(trackedAnalytics) {\n  // try to get the process version from node, but if we're on the client return 0.0.0\n  const defaults = {\n    techVersion: getNodeVersion(),\n    sdkCode: 'T',\n    sdkSemver: packageVersion.split('-')[0],\n    product: 'A',\n    osType: 'Z',\n    osVersion: '0.0',\n    responsive: false,\n    placeholder: false,\n    lazyload: false,\n    accessibility: false\n  };\n\n  if (!trackedAnalytics) {\n    return defaults;\n  } else {\n    return Object.assign(Object.assign({}, defaults), trackedAnalytics);\n  }\n}\n/**\n * @private\n * @description Creates the complete SDK signature by using all the values provided by ITrackedPropertiesThroughAnalytics\n *              Creation of the signature\n *              - Set the AlgoVersion of the encoding, this is an internal letter that represents the version\n *                of our encoding algorithm, it will allow us to perform breaking changes if we'll need them.\n *              - Take the constant SDK code (Arbitrary letter chosen for each SDK, for Base that letter is 'T')\n *                this is used to tell apart which SDK is being tracked.\n *              - Take the {major.minor} versions of the node version (techVersion) (14.2, 16.2 etc.)\n *              - Take the full semver of the SDK you wish to track\n *              - Take the features used(lazy, placeholder etc.) and turn them to a letter (for example accessibility -> D)\n *              - Before appending the string, the Versions must be encoded, see the function `encodeVersion` for more details\n *              - Append all the variables to a single string\n *              - In any case of an error, return the single letter 'E'\n *\n * @return {string} sdkAnalyticsSignature\n */\n\n\nexport function getSDKAnalyticsSignature(_trackedAnalytics) {\n  const trackedAnalytics = ensureShapeOfTrackedProperties(_trackedAnalytics);\n  const analyticsOptions = getAnalyticsOptions(trackedAnalytics);\n\n  try {\n    const twoPartVersion = removePatchFromSemver(analyticsOptions.techVersion);\n    const encodedSDKVersion = encodeVersion(analyticsOptions.sdkSemver);\n    const encodedTechVersion = encodeVersion(twoPartVersion);\n    const encodedOSVersion = encodeOSVersion(analyticsOptions.osVersion);\n    const featureCode = analyticsOptions.feature;\n    const SDKCode = analyticsOptions.sdkCode;\n    const {\n      product,\n      osType\n    } = analyticsOptions;\n    const algoVersion = 'D'; // The algo version is determined here, it should not be an argument\n\n    return `${algoVersion}${product}${SDKCode}${encodedSDKVersion}${encodedTechVersion}${osType}${encodedOSVersion}${featureCode}`;\n  } catch (e) {\n    // Either SDK or Node versions were unparsable\n    return 'E';\n  }\n}\n/**\n * @private\n * @description Removes patch version from the semver if it exists\n *              Turns x.y.z OR x.y into x.y\n * @param {'x.y.z' | 'x.y' | string} semVerStr\n */\n\nfunction removePatchFromSemver(semVerStr) {\n  const parts = semVerStr.split('.');\n  return `${parts[0]}.${parts[1]}`;\n}","map":{"version":3,"names":["encodeVersion","getAnalyticsOptions","packageVersion","encodeOSVersion","getNodeVersion","failedVersion","window","process","versions","node","e","ensureShapeOfTrackedProperties","trackedAnalytics","defaults","techVersion","sdkCode","sdkSemver","split","product","osType","osVersion","responsive","placeholder","lazyload","accessibility","Object","assign","getSDKAnalyticsSignature","_trackedAnalytics","analyticsOptions","twoPartVersion","removePatchFromSemver","encodedSDKVersion","encodedTechVersion","encodedOSVersion","featureCode","feature","SDKCode","algoVersion","semVerStr","parts"],"sources":["C:/Users/DELL/OneDrive/Desktop/New folder (2)/New folder/node_modules/@cloudinary/url-gen/sdkAnalytics/getSDKAnalyticsSignature.js"],"sourcesContent":["import { encodeVersion } from \"./encodeVersion.js\";\nimport { getAnalyticsOptions } from \"./getAnalyticsOptions.js\";\nimport { packageVersion } from \"../internal/utils/packageVersion.js\";\nimport { encodeOSVersion } from \"./encodeOSVersion.js\";\n/**\n * @private\n * @description Try to get the node version out of process, if browser just return 0.0.0\n */\nfunction getNodeVersion() {\n    const failedVersion = '0.0.0';\n    if (typeof window !== 'undefined') {\n        return failedVersion;\n    }\n    else {\n        // node env\n        try {\n            return process.versions.node || failedVersion;\n        }\n        catch (e) {\n            return failedVersion;\n        }\n    }\n}\n/**\n * @private\n * @description Ensure that all values ITrackedPropertiesThroughAnalytics are populated.\n * Accept a partial map of values and returns the complete interface of ITrackedPropertiesThroughAnalytics\n * @param {ITrackedPropertiesThroughAnalytics} trackedAnalytics\n * @param {ITrackedPropertiesThroughAnalytics} trackedAnalytics\n */\nfunction ensureShapeOfTrackedProperties(trackedAnalytics) {\n    // try to get the process version from node, but if we're on the client return 0.0.0\n    const defaults = {\n        techVersion: getNodeVersion(),\n        sdkCode: 'T',\n        sdkSemver: packageVersion.split('-')[0],\n        product: 'A',\n        osType: 'Z',\n        osVersion: '0.0',\n        responsive: false,\n        placeholder: false,\n        lazyload: false,\n        accessibility: false\n    };\n    if (!trackedAnalytics) {\n        return defaults;\n    }\n    else {\n        return Object.assign(Object.assign({}, defaults), trackedAnalytics);\n    }\n}\n/**\n * @private\n * @description Creates the complete SDK signature by using all the values provided by ITrackedPropertiesThroughAnalytics\n *              Creation of the signature\n *              - Set the AlgoVersion of the encoding, this is an internal letter that represents the version\n *                of our encoding algorithm, it will allow us to perform breaking changes if we'll need them.\n *              - Take the constant SDK code (Arbitrary letter chosen for each SDK, for Base that letter is 'T')\n *                this is used to tell apart which SDK is being tracked.\n *              - Take the {major.minor} versions of the node version (techVersion) (14.2, 16.2 etc.)\n *              - Take the full semver of the SDK you wish to track\n *              - Take the features used(lazy, placeholder etc.) and turn them to a letter (for example accessibility -> D)\n *              - Before appending the string, the Versions must be encoded, see the function `encodeVersion` for more details\n *              - Append all the variables to a single string\n *              - In any case of an error, return the single letter 'E'\n *\n * @return {string} sdkAnalyticsSignature\n */\nexport function getSDKAnalyticsSignature(_trackedAnalytics) {\n    const trackedAnalytics = ensureShapeOfTrackedProperties(_trackedAnalytics);\n    const analyticsOptions = getAnalyticsOptions(trackedAnalytics);\n    try {\n        const twoPartVersion = removePatchFromSemver(analyticsOptions.techVersion);\n        const encodedSDKVersion = encodeVersion(analyticsOptions.sdkSemver);\n        const encodedTechVersion = encodeVersion(twoPartVersion);\n        const encodedOSVersion = encodeOSVersion(analyticsOptions.osVersion);\n        const featureCode = analyticsOptions.feature;\n        const SDKCode = analyticsOptions.sdkCode;\n        const { product, osType } = analyticsOptions;\n        const algoVersion = 'D'; // The algo version is determined here, it should not be an argument\n        return `${algoVersion}${product}${SDKCode}${encodedSDKVersion}${encodedTechVersion}${osType}${encodedOSVersion}${featureCode}`;\n    }\n    catch (e) {\n        // Either SDK or Node versions were unparsable\n        return 'E';\n    }\n}\n/**\n * @private\n * @description Removes patch version from the semver if it exists\n *              Turns x.y.z OR x.y into x.y\n * @param {'x.y.z' | 'x.y' | string} semVerStr\n */\nfunction removePatchFromSemver(semVerStr) {\n    const parts = semVerStr.split('.');\n    return `${parts[0]}.${parts[1]}`;\n}\n"],"mappings":"AAAA,SAASA,aAAT,QAA8B,oBAA9B;AACA,SAASC,mBAAT,QAAoC,0BAApC;AACA,SAASC,cAAT,QAA+B,qCAA/B;AACA,SAASC,eAAT,QAAgC,sBAAhC;AACA;AACA;AACA;AACA;;AACA,SAASC,cAAT,GAA0B;EACtB,MAAMC,aAAa,GAAG,OAAtB;;EACA,IAAI,OAAOC,MAAP,KAAkB,WAAtB,EAAmC;IAC/B,OAAOD,aAAP;EACH,CAFD,MAGK;IACD;IACA,IAAI;MACA,OAAOE,OAAO,CAACC,QAAR,CAAiBC,IAAjB,IAAyBJ,aAAhC;IACH,CAFD,CAGA,OAAOK,CAAP,EAAU;MACN,OAAOL,aAAP;IACH;EACJ;AACJ;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASM,8BAAT,CAAwCC,gBAAxC,EAA0D;EACtD;EACA,MAAMC,QAAQ,GAAG;IACbC,WAAW,EAAEV,cAAc,EADd;IAEbW,OAAO,EAAE,GAFI;IAGbC,SAAS,EAAEd,cAAc,CAACe,KAAf,CAAqB,GAArB,EAA0B,CAA1B,CAHE;IAIbC,OAAO,EAAE,GAJI;IAKbC,MAAM,EAAE,GALK;IAMbC,SAAS,EAAE,KANE;IAObC,UAAU,EAAE,KAPC;IAQbC,WAAW,EAAE,KARA;IASbC,QAAQ,EAAE,KATG;IAUbC,aAAa,EAAE;EAVF,CAAjB;;EAYA,IAAI,CAACZ,gBAAL,EAAuB;IACnB,OAAOC,QAAP;EACH,CAFD,MAGK;IACD,OAAOY,MAAM,CAACC,MAAP,CAAcD,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBb,QAAlB,CAAd,EAA2CD,gBAA3C,CAAP;EACH;AACJ;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,OAAO,SAASe,wBAAT,CAAkCC,iBAAlC,EAAqD;EACxD,MAAMhB,gBAAgB,GAAGD,8BAA8B,CAACiB,iBAAD,CAAvD;EACA,MAAMC,gBAAgB,GAAG5B,mBAAmB,CAACW,gBAAD,CAA5C;;EACA,IAAI;IACA,MAAMkB,cAAc,GAAGC,qBAAqB,CAACF,gBAAgB,CAACf,WAAlB,CAA5C;IACA,MAAMkB,iBAAiB,GAAGhC,aAAa,CAAC6B,gBAAgB,CAACb,SAAlB,CAAvC;IACA,MAAMiB,kBAAkB,GAAGjC,aAAa,CAAC8B,cAAD,CAAxC;IACA,MAAMI,gBAAgB,GAAG/B,eAAe,CAAC0B,gBAAgB,CAACT,SAAlB,CAAxC;IACA,MAAMe,WAAW,GAAGN,gBAAgB,CAACO,OAArC;IACA,MAAMC,OAAO,GAAGR,gBAAgB,CAACd,OAAjC;IACA,MAAM;MAAEG,OAAF;MAAWC;IAAX,IAAsBU,gBAA5B;IACA,MAAMS,WAAW,GAAG,GAApB,CARA,CAQyB;;IACzB,OAAQ,GAAEA,WAAY,GAAEpB,OAAQ,GAAEmB,OAAQ,GAAEL,iBAAkB,GAAEC,kBAAmB,GAAEd,MAAO,GAAEe,gBAAiB,GAAEC,WAAY,EAA7H;EACH,CAVD,CAWA,OAAOzB,CAAP,EAAU;IACN;IACA,OAAO,GAAP;EACH;AACJ;AACD;AACA;AACA;AACA;AACA;AACA;;AACA,SAASqB,qBAAT,CAA+BQ,SAA/B,EAA0C;EACtC,MAAMC,KAAK,GAAGD,SAAS,CAACtB,KAAV,CAAgB,GAAhB,CAAd;EACA,OAAQ,GAAEuB,KAAK,CAAC,CAAD,CAAI,IAAGA,KAAK,CAAC,CAAD,CAAI,EAA/B;AACH"},"metadata":{},"sourceType":"module"}